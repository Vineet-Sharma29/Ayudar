
<!doctype html>
<html>

<head>
    <title>Student Graphs</title>
{% load static %}
 <script src="{% static 'Chart.bundle.js' %}"></script>
    <script src="{% static 'utils.js' %}"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
	/*style for the box*/

	
	.printchatbox 
    {border-width:thick 10px;border-style: solid; 
    background-color:#fff;
    line-height: 2;color:#6E6A6B;font-size: 14pt;text-align:left;float: middle;
    border: 3px solid #969293;width:40%;
     height:2em; 
	 
	 /*finish*/
	 
  
    </style>
	<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="{% static 'w3.css' %}">
</head>

<body>


<p id="print"> 
</p>
<script>

var y= document.getElementById("data");
console.log(y);


var inputBox = document.getElementById('chatinput');

inputBox.onkeyup = function(){
    document.getElementById('printchatbox').innerHTML = inputBox.value;
}


</script>

<div>
    <form class="form-horizontal well" style="background-color:black;">
      <fieldset>
          <label for="csvFileInput" style="color:white;"> <strong>CSV File:</strong>
          </label>
          <input type="file" id="csvFileInput" onchange="handleFiles(this.files)"
          accept=".csv">
        </div>
      </fieldset>
    </form>
    <div id="output">
    </div>
  </div>
  <br>
  <br>


    <div id="container" style="width: 100%;">
        <canvas id="canvas1"></canvas>
	</div>
	<div id="container" style="width: 50%; float:left;">
		<canvas id="canvas2" style="height:50%;"></canvas>
    </div>
	<div id="container" style="width: 50%; float:right;">
		<canvas id="canvas3" style="height:50%;"></canvas>
    </div>
  
    <script>
	var lines = [];
	var check = 4 ;
	function handleFiles(files) {
	// Check for the various File API support.
	if (window.FileReader) {
		// FileReader are supported.
		getAsText(files[0]);
	} else {
		alert('FileReader are not supported in this browser.');
	}
}

function getAsText(fileToRead) {
	var reader = new FileReader();
	// Handle errors load
	reader.onload = loadHandler;
	reader.onerror = errorHandler;
	// Read file into memory as UTF-8      
	reader.readAsText(fileToRead);
}

function loadHandler(event) {
	var csv = event.target.result;
	processData(csv);             
}

function processData(csv) {
    var allTextLines = csv.split(/\r\n|\n/);
    
    while (allTextLines.length) {
        lines.push(allTextLines.shift().split(','));
    }
	
	drawOutput(lines);
}

function Compare()
{
	console.log(lines);
	lineGraph(lines, check);
	check-- ; 
}

function errorHandler(evt) {
	if(evt.target.error.name == "NotReadableError") {
		alert("Canno't read file !");
	}
}

function drawOutput(lines){
	//Clear previous data
	document.getElementById("output").innerHTML = "";
	var table = document.createElement("table");
	for (var i = 0; i < lines.length; i++) {
		var row = table.insertRow(-1);
		for (var j = 0; j < lines[i].length; j++) {
			var firstNameCell = row.insertCell(-1);
			firstNameCell.appendChild(document.createTextNode(lines[i][j]));
		}
	}
	console.log(lines);
	document.getElementById("output").appendChild(table);
	lineGraph(lines, check);
}
    function lineGraph(lines, check)
	{
	    //   Split Function for data
		lines[0].toString()	.trim();
		var t0 = lines[0].toString().split(',');
		console.log(t0);
		
		
		
		lines[1].toString()	.trim();
		var t1 = lines[1].toString().split(',');
		t1=t1.map(function(item){return parseInt(item, 10);});
		console.log(t1);
		
		lines[2].toString()	.trim();
		var t2 = lines[2].toString().split(',');
		t2=t2.map(function(item){return parseInt(item, 10);});
		console.log(t2);
		
		lines[3].toString()	.trim();
		var t3 = lines[3].toString().split(',');
		t3=t3.map(function(item){return parseInt(item, 10);});
		console.log(t3);
		
		lines[4].toString()	.trim();
		var t4 = lines[4].toString().split(',');
		t4=t4.map(function(item){return parseInt(item, 10);});
		console.log(t4);
			
		lines[5].toString()	.trim();
		var t5 = lines[5].toString().split(',');
		t5=t5.map(function(item){return parseInt(item, 10);});
		console.log(t5);
		var t= [t1, t2, t3, t4,t5];
		
		console.log(datafill(5,t));
		var index ;
		if(check==0)
		{
		index=4;
		check=4;
		}
		else 
		index=check;
		var config = {
            type: 'bar',
            data: {
                labels: t0,
                datasets: datafill(index,t)
            },
            options: {
                responsive: true,
                title:{
                    display:true,
                    text: lines[6]
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Courses IIITS'
                        }
                    }],
                    yAxes: [{ticks: {
								beginAtZero: true
							},
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Marks Scored'
                        }
                    }]
                }
            }
        };






        
		var config1 = {
            type: 'line',
            data: {
                labels: t0,
                datasets: datafill(index,t)
            },
            options: {
                responsive: true,
                title:{
                    display:true,
                    text: lines[6]
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Courses IIITS'
                        }
                    }],
                    yAxes: [{ticks: {
								beginAtZero: true
							},
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Marks Scored'
                        }
                    }]
                }
            }
        };
		var config2 = {
            type: 'radar',
            data: {
                labels: t0,
                datasets: datafill(index,t)
            },
            options: {
                responsive: true,
                title:{
                    display:true,
                    text: lines[6]
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Courses IIITS'
                        }
                    }],
                    yAxes: [{ticks: {
								beginAtZero: true
							},
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Marks Scored'
                        }
                    }]
                }
            }
        };

       
            var ctx = document.getElementById("canvas1").getContext("2d");
			var ctx1 = document.getElementById("canvas2").getContext("2d");
			var ctx2 = document.getElementById("canvas3").getContext("2d");
            window.myLine = new Chart(ctx, config);
			window.myLine = new Chart(ctx1, config1);
			window.myLine = new Chart(ctx2, config2);
       

	}
	
		
		function datafill(index, t)
		{
		colorArray=[window.chartColors.red,window.chartColors.blue,window.chartColors.green,window.chartColors.yellow,window.chartColors.orange];
		var dataFill=[];
			for(var i=0;i<=index;i++)
			{
                var dataEle=   { label: (i+1)+"th quiz",
                    backgroundColor: colorArray[i],
                    borderColor: colorArray[i],
                    data: t[i],
                    fill: false};
				dataFill.push(dataEle);	
			}
			return dataFill;
		}	

    </script>
    <br>
	</body>
	</html>